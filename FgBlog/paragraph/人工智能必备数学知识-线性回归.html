<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div class="markdown-body"><!---1195006337--><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre>code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote>p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}
</style>
    <h1>线性回归—一个典型的机器学习</h1>
    <h2 id="one">人工智能</h2>
    <h3>人工智能的概念</h3>
    <p>说到人工智能，就不要说一下人工智能的几个专业名词的关系</p>
    <p><code>人工智能、机器学习、深度学习</code>，就是这三个东西他们是什么呢。</p>
    <p>就其实他们是有一种包含的关系，人工智能描述的是就是你觉得是人工智能的东西。比如智能机器人啊，无人驾驶啊，人脸识别啊，讲道理吼，都算在人工智能里。</p>
    <p>然后呢，人工智能里有一部份的都会用到机器学习，因为呢说白了人工智能还是一个输入输出的模型，跟人一样，看到东西然后去理解去学习，就人嘛一开始也是笨笨的，后来慢慢的自己去领悟规则，那机器学习就是这样一部分那最基础的呢大概就是：线性回归啊，kNN啊，SVM啊。</p>
    <p>学习的能力肯定也有高也有低的，更强的学习能力的呢，就是深度学习这种。高仿人类学习方法的自己学习的能力。比如围棋的阿尔法狗啊，dota里的OPENAI啊，象棋里的阿尔法猫啊旋风之类很多的都是需要用到深度学习的技术，去增强他的学习能力，和让他自己调优</p>
    <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/af94bf0482994d6ea7dff7ac399ff1c3~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
    <h3>机器学习的本质</h3>
    <p>以数据为驱动，自主的从数据中寻找规律的方法</p>
    <p>1、更少的人为假设和定义</p>
    <p>2、更灵活的应用</p>
    <p>3、更高的准确度</p>
    <h3>常见的机器学习方法</h3>
    <p>模型：f(x)</p>
    <p>机器学习：模型应用在学习上，在数据中找到规律的能力</p>
    <p>一般有下面的这些方法</p>
    <p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/39739bf8a03c424099ee6e0a340fcb6f~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
    <h2 id="two">回归</h2>
    <h3>概念</h3>
    <p>根据已有数据，简历因变量Y与自变量X的定量（函数）关系模型</p>
    <p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/108d053aa5d446f0aa59919dd694deed~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
    <h3>例子</h3>
    <p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c261bc754ae9499bb796f987153a6851~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
    <p>根据给出的数据，拿出对应的回归，在有新自变量出现的时候，可以预测因变量的值</p>
    <h3>线性回归</h3>
    <p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/83f9f57576df4c4991a3157828da07fc~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
    <p>案例：用水量和水费的关系啊、车速和行驶距离的关系啊，一动脑袋能想到的很简单的很多都是线性回归。</p>
    <h4>求解线性回归</h4>
    <p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/628f0ca9781d493a9e4213296ef4eeec~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
    <p>搭建一个产量y = f(时长x)的关系</p>
    <p>但是就会有个问题，这些数据，放入一个
    <code>y=ax+b</code>的函数里，能求出不同的很多直线，到底哪条才是合适的呢，或者这些直线都不合适，需要调优。但是我们就要怎么去评价这个线性回归模型的好坏呢？</p>
    <h4>评价回归模型表现的好坏</h4>
    <p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0a72a4a037c44363ba525e44a8d2f957~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
    <p>图片里的代数式，求出来的内容就是<code>均方误差</code></p>
    <p>还是用上面的条件，举一个计算均方误差的样例</p>
    <pre><code>假设我们用第二组数据，305 = 30a + b
    算出来一条直线
    y = 10x + 5
    
    我们把数据带入可以得到新表
    
    时长        产量      用新表的数据减去旧的
    20         205     （205 - 195）**2= 100
    30         305     （305 - 305）**2 = 0
    50         505     （505 - 480）**2 = 625
    60         580     （605 - 580）**2 = 625
    
    再把结果累加
    
    均方误差的和就是 1350
    
    </code></pre>
    <p>当然这条直线就是拿了一个点就凭感觉写出来的，对于整个数据这个误差好像还是挺大的。</p>
    <p>看到误差以后就会觉得是不是<code>y = 10x -5 </code>更合适一点</p>
    <p>但是在一次计算<code>y = 10x -5</code>可能你还是会觉得不够合适</p>
    <p>这个时候可能我们就需要一套算法去找到最优的a，b，也就是找到最小的均方误差,那么用什么方法呢</p>
    <h3>最小二乘法</h3>
    <p>那肯定就有很多同学就想到了，对就是他最小二乘法，首先我们把公式放在这里。</p>
    <p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/449fc62e101e4a0a937179d5dd4c0d05~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
    <p>然后问题就来了，这个a,b的式子是怎么出来的呢，复习一下，我们用手推到一次</p>
    <pre><code>1）我们首先有个y = ax + b
2）给定的数据（x1，y1）,(x2,y2),....(xi,yi)
3）我们有一个表示误差值的di = yi - y带入一下开始的y = ax + b就是di = yi - (axi+b)
4)当D = 最小均方误差（就是上一节的那个式子）取最小的时候就是他的导数取到极值点的时候，所以我们要对这个式子的a,b求偏导。
    首先把各项式子带入进均方误差的公式里，然后。。。。。。
。。。。。。。。。。
。。。。。。。
。。。。。。。。。。。。。。。。。。。。。写不下去了。。。。。。。。。。。。。。。。。。。

    </code></pre>
    <p>太多符号了，太难写了，我自己手写推了一遍，字太丑就不放上来了。放一个别人推的</p>
    <p><a href="https://blog.csdn.net/genghaihua/article/details/90058327" target="_blank" rel="nofollow noopener noreferrer"></a><a href="https://blog.csdn.net/genghaihua/article/details/90058327" target="_blank" rel="nofollow noopener noreferrer">https://blog.csdn.net/genghaihua/article/details/90058327</a></p>
    <p>再放一个用高中方法推的<a href="https://www.bilibili.com/video/BV1Sg4y1v7dL?from=search&amp;seid=2285612612723993681" target="_blank" rel="nofollow noopener noreferrer"></a><a href="https://www.bilibili.com/video/BV1Sg4y1v7dL?from=search&amp;seid=2285612612723993681" target="_blank" rel="nofollow noopener noreferrer">https://www.bilibili.com/video/BV1Sg4y1v7dL?from=search&amp;seid=2285612612723993681</a></p>
    <p>好！那么就当是你们看到我亲自推倒了一遍。</p>
    <h2 id="three">代码题</h2>
    <p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/be4f6907566743948de2a873dc2e7f1e~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
    <p>先试用一下各种功能</p>
    <pre><code>
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import sklearn
from sklearn.linear_model import LinearRegression

x = np.linspace(1, 100, 100)

y = 5 * x + 10 + 10 * np.random.randn(100)
print(x)
print(y)

model = LinearRegression()

x = x.reshape(100, 1)
print(x)
y = y.reshape(100, 1)
print(y)
model.fit(x, y)

y_p = model.predict(x)

plt.plot(x, y, ".k")
plt.plot(x, y_p, "b")
plt.show()


    
    </code></pre>
    <p>后面真的做题就是拿真实数据去做了</p>
    <pre><code>
data = pd.read_csv("data.csv")#这个是存好数据的文件

print(data.head)

data = data.values

print(data)

x = data[:,1,3]
y = data[:,3]

print(x)
print(y)

from sklearn.linear_model import LinearRegression

model = LinearRegression()

model.fit(x,y)

predict = model.predict(x)

print(predict)

plt.plot(y,predict,".b")

plt.show()


diff = predict-y

mae = np.mean(np.abs(diff))

print(mae)

rmse = np.sqrt(np.mean(diff**2))

print(rmse)

print(np.mean(y))

print(140/4600)
    
    
    </code></pre>
<style>.markdown-body pre,.markdown-body pre>code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style></div>
</body>
</html>